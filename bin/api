#!/bin/bash

dir=roles/api/files 
cd $dir || exec echo "ERROR: $dir/app.rb does not exist!"

cmd="$1"
shift
case "$cmd" in
analyze)
  echo Analyzing in: $PWD
  bundle exec bin/analyze-scrapers.rb "$@"
  ;;
console)
  echo Console in: $PWD
  bundle exec bin/console "$@"
  ;;
rake)
  bundle exec rake "$@"
  ;;
rspec)
  bundle exec rspec "$@"
  ;;
server)
  mkdir -p ../../../tmp/html
  (
  cd ../..
  ln -nfs $PWD/web/files/{robots.txt,assets,favicon.ico}  ../tmp/html
  ln -nfs $PWD/web/files/contents/{errors,whats_that}  ../tmp/html
  )      
  bundle exec rackup "$@"
  ;;
shell)
  echo PWD: $PWD
  bundle exec bash "$@"
  ;;
*)
  echo "Usage: $0 analyze|console|rake|server|shell"
  ;;
esac

